<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FL1PVPN</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-deep: #050507;
            --glass-surface: rgba(20, 20, 25, 0.6);
            --glass-border: rgba(255, 255, 255, 0.06);
            --glass-highlight: rgba(255, 255, 255, 0.08);
            
            --primary: #6366f1;
            --primary-glow: rgba(99, 102, 241, 0.4);
            
            --text-main: #ffffff;
            --text-sec: #94a3b8;
            
            --c-green: #10b981;
            --c-yellow: #facc15;
            --c-red: #ef4444;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-main);
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
            overflow-x: hidden;
        }

        /* –ñ–∏–≤–æ–π —Ñ–æ–Ω */
        .ambient {
            position: fixed; inset: 0; z-index: -1;
            background: 
                radial-gradient(circle at 10% 20%, rgba(79, 70, 229, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(139, 92, 246, 0.15) 0%, transparent 40%);
            animation: breathe 8s ease-in-out infinite alternate;
        }

        .container {
            width: 100%; max-width: 540px;
            padding: 20px;
            padding-bottom: 40px;
            z-index: 1;
        }

        /* Header */
        header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 24px; padding: 12px 4px;
        }

        .logo {
            font-size: 26px; font-weight: 800; letter-spacing: -0.5px;
            background: linear-gradient(135deg, #fff 30%, #a5b4fc 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            display: flex; align-items: center; gap: 8px;
        }

        .status {
            font-size: 13px; font-weight: 600;
            padding: 8px 14px; border-radius: 30px;
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(10px);
            display: flex; align-items: center; gap: 8px;
            transition: 0.3s;
        }
        .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--text-sec); box-shadow: 0 0 10px currentColor; transition: 0.3s; }

        /* Scrollable Filters */
        .filters {
            display: flex; gap: 10px; overflow-x: auto; 
            padding-bottom: 4px; margin-bottom: 20px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .filters::-webkit-scrollbar { display: none; }

        .chip {
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--glass-border);
            color: var(--text-sec);
            padding: 10px 18px; border-radius: 14px;
            font-size: 13px; font-weight: 600; white-space: nowrap;
            cursor: pointer; transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        
        .chip.active {
            background: var(--primary);
            color: #fff; border-color: var(--primary);
            box-shadow: 0 4px 20px var(--primary-glow);
            transform: translateY(-2px);
        }
        .chip:active { transform: scale(0.95); }

        /* Grid */
        .grid { display: flex; flex-direction: column; gap: 14px; }

        .card {
            background: var(--glass-surface);
            border: 1px solid var(--glass-border);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border-radius: 22px; padding: 20px;
            display: flex; justify-content: space-between; align-items: center;
            cursor: pointer; position: relative; overflow: hidden;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            opacity: 0; transform: translateY(20px); /* For animation */
        }

        .card:active { transform: scale(0.98); }
        .card:hover {
            border-color: rgba(99, 102, 241, 0.4);
            background: rgba(30, 32, 50, 0.7);
            box-shadow: 0 12px 30px -10px rgba(0,0,0,0.6);
        }

        /* Shine Effect */
        .card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.05), transparent);
            transform: skewX(-20deg); transition: 0.5s; pointer-events: none;
        }
        .card:hover::before { left: 100%; transition: 0.7s; }

        .card-main { display: flex; align-items: center; gap: 16px; }

        .flag-wrap {
            width: 48px; height: 48px; border-radius: 14px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden; flex-shrink: 0;
            display: flex; align-items: center; justify-content: center;
        }
        .flag-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.9; }

        .info h3 { margin: 0; font-size: 17px; font-weight: 700; letter-spacing: 0.2px; color: #fff; }
        .info p { margin: 4px 0 0; font-size: 12px; color: var(--text-sec); font-weight: 500; }
        
        .badge {
            font-size: 10px; font-weight: 800; text-transform: uppercase;
            padding: 3px 8px; border-radius: 6px; margin-left: 8px;
            vertical-align: middle; letter-spacing: 0.5px;
        }

        .ping-wrap { text-align: right; min-width: 60px; }
        .ping-val { font-size: 16px; font-weight: 800; display: block; }
        .ping-lbl { font-size: 11px; color: var(--text-sec); display: block; margin-top: 2px;}

        /* Whitelist Alert Text (Neutral) */
        .wl-note {
            font-size: 11px; color: var(--c-yellow); margin-top: 6px; 
            display: flex; align-items: center; gap: 6px;
            background: rgba(250, 204, 21, 0.1); padding: 4px 8px; 
            border-radius: 6px; width: fit-content;
        }

        /* Modal */
        .overlay {
            position: fixed; inset: 0; z-index: 100;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(8px);
            opacity: 0; pointer-events: none; transition: 0.3s ease;
            display: flex; align-items: flex-end; justify-content: center;
        }
        .overlay.open { opacity: 1; pointer-events: all; }

        .sheet {
            background: #121216; width: 100%; max-width: 540px;
            border-radius: 32px 32px 0 0; padding: 32px 24px 40px;
            transform: translateY(100%); transition: 0.4s cubic-bezier(0.19, 1, 0.22, 1);
            border-top: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 -10px 50px rgba(0,0,0,0.7);
        }
        .overlay.open .sheet { transform: translateY(0); }

        .sheet-head { display: flex; align-items: center; gap: 16px; margin-bottom: 30px; }
        .sheet-title { font-size: 24px; font-weight: 800; margin: 0; }
        
        .detail-row {
            display: flex; justify-content: space-between; padding: 18px 0;
            border-bottom: 1px solid rgba(255,255,255,0.06); font-size: 15px;
        }
        .d-lbl { color: var(--text-sec); }
        .d-val { font-weight: 600; color: #fff; }

        .btn-main {
            width: 100%; margin-top: 32px; padding: 20px;
            border: none; border-radius: 20px;
            background: linear-gradient(135deg, var(--primary), #4f46e5);
            color: #fff; font-size: 16px; font-weight: 700;
            cursor: pointer; box-shadow: 0 8px 30px rgba(99, 102, 241, 0.3);
            transition: transform 0.2s;
        }
        .btn-main:active { transform: scale(0.97); }

        .loader {
            width: 44px; height: 44px; border: 4px solid rgba(255,255,255,0.1);
            border-top-color: var(--primary); border-radius: 50%;
            animation: spin 0.8s cubic-bezier(0.6, 0.2, 0.4, 0.8) infinite;
            margin: 60px auto;
        }

        @keyframes breathe { 0% { opacity: 0.6; } 100% { opacity: 1; } }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes popIn { 
            from { opacity: 0; transform: translateY(20px) scale(0.95); } 
            to { opacity: 1; transform: translateY(0) scale(1); } 
        }

    </style>
</head>
<body>

<div class="ambient"></div>

<div class="container">
    <header>
        <div class="logo">
            <span>‚ö° FL1PVPN</span>
        </div>
        <div class="status" id="statusBadge">
            <div class="dot"></div> <span id="statusText">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </header>

    <div class="filters">
        <button class="chip active" onclick="setFilter('all', this)">–í—Å–µ</button>
        <button class="chip" onclick="setFilter('fastest', this)">üèÜ –¢–æ–ø –°–∫–æ—Ä–æ—Å—Ç—å</button>
        <button class="chip" onclick="setFilter('gaming', this)">üéÆ –î–ª—è –ò–≥—Ä</button>
        <button class="chip" onclick="setFilter('media', this)">üé¨ YouTube (4K)</button>
        <button class="chip" onclick="setFilter('privacy', this)">üåê –ü–æ–ª–Ω–∞—è –°–º–µ–Ω–∞</button>
        <button class="chip" onclick="setFilter('ru', this)">üá∑üá∫ Whitelist</button>
    </div>

    <div id="grid" class="grid">
        <div class="loader"></div>
    </div>
</div>

<div class="overlay" id="modal" onclick="closeModal(event)">
    <div class="sheet">
        <div class="sheet-head">
            <div class="flag-wrap" style="width: 56px; height: 56px;">
                <img id="mFlag" class="flag-img" src="">
            </div>
            <div>
                <h2 class="sheet-title" id="mCountry">–°—Ç—Ä–∞–Ω–∞</h2>
                <div style="font-size: 14px; color: var(--text-sec); margin-top:4px" id="mType">Protocol</div>
            </div>
        </div>
        
        <div class="detail-row">
            <span class="d-lbl">IP –ê–¥—Ä–µ—Å</span>
            <span class="d-val" id="mIP">...</span>
        </div>
        <div class="detail-row">
            <span class="d-lbl">–ü–∏–Ω–≥</span>
            <span class="d-val" id="mPing">...</span>
        </div>
        <div class="detail-row">
            <span class="d-lbl">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span>
            <span class="d-val" id="mCat">...</span>
        </div>

        <button class="btn-main" onclick="openBot()">üîí –ü–æ–¥–∫–ª—é—á–∏—Ç—å –≤ –ë–æ—Ç–µ</button>
    </div>
</div>

<script>
    const JSON_URL = "stats.json";
    const BOT_URL = "https://t.me/fl1pvpnbot";
    let allData = [];

    async function init() {
        if(window.location.protocol === 'file:') {
            renderError("–ó–∞–ø—É—Å–∫ –∏–∑ —Ñ–∞–π–ª–∞", "–ë—Ä–∞—É–∑–µ—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.");
            return;
        }

        try {
            const res = await fetch(JSON_URL + "?t=" + Date.now());
            if(!res.ok) throw new Error("–ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è");
            const data = await res.json();
            
            if(!data.servers || !data.servers.length) throw new Error("–°–ø–∏—Å–æ–∫ –ø—É—Å—Ç");
            
            allData = data.servers;
            updateStatus(true);
            setFilter('all', document.querySelector('.chip'));

        } catch (e) {
            console.error(e);
            renderError("–°–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", "–ò–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
            updateStatus(false);
        }
    }

    function setFilter(mode, el) {
        document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
        if(el) el.classList.add('active');

        let result = [];

        switch(mode) {
            case 'fastest':
                // –ß–µ—Å—Ç–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–∏–Ω–≥—É
                result = [...allData].sort((a,b) => (parseInt(a.ping)||999) - (parseInt(b.ping)||999));
                break;

            case 'gaming':
                // –ò—Å–∫–ª—é—á–∞–µ–º WARP, –∏—â–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–∏–Ω–≥ + –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç Game Server
                result = allData.filter(s => s.category !== 'WARP');
                result.sort((a,b) => {
                    const scA = (a.category === 'Game Server' ? -50 : 0) + (parseInt(a.ping)||999);
                    const scB = (b.category === 'Game Server' ? -50 : 0) + (parseInt(b.ping)||999);
                    return scA - scB;
                });
                break;

            case 'media':
                // –¢–æ–ª—å–∫–æ WARP (–∏–¥–µ–∞–ª—å–Ω–æ –¥–ª—è YouTube)
                result = allData.filter(s => s.category === 'WARP');
                result.sort((a,b) => (parseInt(a.ping)||999) - (parseInt(b.ping)||999));
                break;

            case 'privacy':
                // Reality / Universal - –ø–æ–ª–Ω–∞—è —Å–º–µ–Ω–∞ IP
                result = allData.filter(s => s.category === 'UNIVERSAL' || s.category === 'Game Server');
                result.sort((a,b) => (parseInt(a.ping)||999) - (parseInt(b.ping)||999));
                break;

            case 'ru':
                // Whitelist
                result = allData.filter(s => s.category === 'WHITELIST');
                break;

            default: // all
                result = [...allData];
                // –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: Game -> Universal -> Warp -> White
                const rank = { 'Game Server':1, 'UNIVERSAL':2, 'WARP':3, 'WHITELIST':4 };
                result.sort((a,b) => {
                    const rA = rank[a.category] || 99;
                    const rB = rank[b.category] || 99;
                    if(rA !== rB) return rA - rB;
                    return (parseInt(a.ping)||999) - (parseInt(b.ping)||999);
                });
        }

        render(result);
    }

    function render(list) {
        const container = document.getElementById('grid');
        container.innerHTML = "";

        if(!list.length) {
            container.innerHTML = `<div style="text-align:center; color:var(--text-sec); padding:40px">–°–µ—Ä–≤–µ—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>`;
            return;
        }

        list.forEach((s, i) => {
            const p = parseInt(s.ping) || 999;
            const online = p > 0 && p < 999;
            
            // –õ–æ–≥–∏–∫–∞ —Ü–≤–µ—Ç–æ–≤
            let color = "var(--c-green)";
            if(p > 100) color = "var(--c-yellow)";
            if(p > 250) color = "var(--c-red)";
            if(!online) color = "var(--text-sec)";

            // –ë–µ–π–¥–∂–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ù–ï–ô–¢–†–ê–õ–¨–ù–´–ï –ù–ê–ó–í–ê–ù–ò–Ø)
            let catName = "Standard";
            let badge = "";
            let note = "";

            if(s.category === 'Game Server') {
                catName = "Gaming Optimized";
                badge = `<span class="badge" style="background:rgba(99,102,241,0.2); color:#a5b4fc">GAME</span>`;
            } else if(s.category === 'WARP') {
                catName = "Media / YouTube";
                badge = `<span class="badge" style="background:rgba(250,204,21,0.15); color:#fde047">MEDIA</span>`;
            } else if(s.category === 'WHITELIST') {
                catName = "RU Only";
                badge = `<span class="badge" style="background:rgba(255,255,255,0.1)">RU-NET</span>`;
                // –ë–ï–ó–û–ü–ê–°–ù–ê–Ø –§–û–†–ú–£–õ–ò–†–û–í–ö–ê
                note = `<div class="wl-note">‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –µ—Å–ª–∏ —É –≤–∞—Å –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∞–π—Ç—ã –†–§</div>`;
            } else if(s.category === 'UNIVERSAL') {
                catName = "Global Access";
            }

            const flag = `https://flagcdn.com/w80/${(s.iso||'xx').toLowerCase()}.png`;

            const el = document.createElement('div');
            el.className = "card";
            el.style.animation = `popIn 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards ${i * 0.04}s`;

            el.innerHTML = `
                <div class="card-main">
                    <div class="flag-wrap">
                        <img src="${flag}" class="flag-img" onerror="this.style.opacity=0.3">
                    </div>
                    <div class="info">
                        <h3>${s.country} ${badge}</h3>
                        <p>${s.type} ‚Ä¢ ${catName}</p>
                        ${note}
                    </div>
                </div>
                <div class="ping-wrap">
                    <span class="ping-val" style="color:${color}">${online ? p : '?'}</span>
                    <span class="ping-lbl">ms</span>
                </div>
            `;
            
            el.onclick = () => showModal(s, flag, color, catName);
            container.appendChild(el);
        });
    }

    function showModal(s, flag, color, catName) {
        document.getElementById('mFlag').src = flag;
        document.getElementById('mCountry').innerText = s.country;
        document.getElementById('mType').innerText = `${s.protocol} // ${s.type}`;
        document.getElementById('mIP').innerText = s.ip;
        document.getElementById('mPing').innerText = s.ping + " ms";
        document.getElementById('mPing').style.color = color;
        document.getElementById('mCat').innerText = catName;
        
        document.getElementById('modal').classList.add('open');
    }

    function closeModal(e) {
        if(e.target.id === 'modal') document.getElementById('modal').classList.remove('open');
    }

    function openBot() {
        window.location.href = BOT_URL;
    }

    function updateStatus(ok) {
        const txt = document.getElementById('statusText');
        const dot = document.querySelector('.dot');
        if(ok) {
            txt.innerText = "Online";
            dot.style.background = "var(--c-green)";
            dot.style.boxShadow = "0 0 10px var(--c-green)";
        } else {
            txt.innerText = "Offline";
            dot.style.background = "var(--c-red)";
            dot.style.boxShadow = "none";
        }
    }

    function renderError(title, msg) {
        document.getElementById('grid').innerHTML = `
            <div style="background:rgba(239,68,68,0.1); border:1px solid rgba(239,68,68,0.2); border-radius:20px; padding:30px; text-align:center;">
                <div style="font-size:32px; margin-bottom:15px">‚ö†Ô∏è</div>
                <div style="font-weight:700; font-size:18px; color:#fff">${title}</div>
                <div style="font-size:14px; color:#fca5a5; margin-top:8px">${msg}</div>
            </div>
        `;
    }

    init();
</script>

</body>
</html>
